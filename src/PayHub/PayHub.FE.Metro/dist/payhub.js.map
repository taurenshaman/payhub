{"version":3,"sources":["webpack://PayHub/webpack/universalModuleDefinition","webpack://PayHub/./src/AppSettings.ts","webpack://PayHub/./src/Components/KeyperingTransferViewModel.ts","webpack://PayHub/./src/Components/index.ts","webpack://PayHub/./src/Core/index.ts","webpack://PayHub/./src/Impl/KeyperingBank.ts","webpack://PayHub/./src/Impl/KeyperingRPC.ts","webpack://PayHub/./src/Impl/KeyperingUtility.ts","webpack://PayHub/./src/Impl/NervosConstants.ts","webpack://PayHub/./src/Impl/NervosParsers.ts","webpack://PayHub/./src/Impl/index.ts","webpack://PayHub/./src/Models/Currency.ts","webpack://PayHub/./src/Models/CurrencyCandidates.ts","webpack://PayHub/./src/Models/WithdrawAccount.ts","webpack://PayHub/./src/Models/index.ts","webpack://PayHub/./src/Tools/BrowserUtility.ts","webpack://PayHub/./src/Tools/DataService.ts","webpack://PayHub/./src/Tools/InputUtility.ts","webpack://PayHub/./src/Tools/NetUtility.ts","webpack://PayHub/./src/Tools/StringUtility.ts","webpack://PayHub/./src/Tools/UIHelper.ts","webpack://PayHub/./src/Tools/index.ts","webpack://PayHub/./src/ViewModels/AccountViewModel.ts","webpack://PayHub/./src/ViewModels/AccountViewModelBase.ts","webpack://PayHub/./src/ViewModels/CurrencyManagerViewModel.ts","webpack://PayHub/./src/ViewModels/SinglePageViewModel.ts","webpack://PayHub/./src/ViewModels/ViewModelBase.ts","webpack://PayHub/./src/ViewModels/WalletViewModel.ts","webpack://PayHub/./src/ViewModels/index.ts","webpack://PayHub/./src/index.ts","webpack://PayHub/external {\"commonjs\":\"vue\",\"commonjs2\":\"vue\",\"amd\":\"vue\",\"root\":[\"Vue\"]}","webpack://PayHub/webpack/bootstrap","webpack://PayHub/webpack/startup"],"names":["root","factory","exports","module","require","define","amd","self","__WEBPACK_EXTERNAL_MODULE__39__","AppSettings","DefaultUnitOfMoney","KeyperingTransferViewModel","ViewModelBase","worker","eleId","super","this","charmId","init","vueSettings","data","coinName","coinUnit","form","toAddress","transferCount","selfProvide","currentCapicity","inputCells","fromSudtCells","biggestCapacityCell","isSUDT","canTransferSUDT","originalSudtCount","BigInt","currentSudtCount","methods","transfer","window","localStorage","getItem","KeyperingUtility","Key_AuthToken","UIHelper","ToastError","mounted","async","app","Vue","createApp","mount","vm","checkCKB","checkSUDT","isKeyperingConnected","combineInputCells","length","shift","calSudtAmount","setLocalStorageDecimal","decimal","parseInt","parseBigIntStringNumber","receiverAddress","check","ShowCharm","toLocaleLowerCase","free","capacity","loading","tokenAmount","req","requestAuth","setItem","token","Key_NetworkId","networkId","console","log","error","authToken","ToastMessage","results","queryAddresses","undefined","address","addresses","filter","lockScriptMeta","name","account","Key_Address","Key_LockHash","lockHash","lockScript","code_hash","SECP256K1_BLAKE160_CODE_HASH","hash_type","args","Key_LockScript","JSON","stringify","cells","getCells","summary","calCapacityAmount","description","response","fetch","KEYPERING_URL","method","body","id","jsonrpc","params","json","result","headers","Authorization","scriptType","script","payload","script_type","getNetworkConst","objects","getTransaction","tx","indexerUrl","signAndSendTransaction","rawTransaction","inputSignConfig","index","witnesses","lock","inputType","outputType","res","message","parse","cell","output","type","sort","cell1","cell2","Number","sudtTypeScript","sudtCells","compareScript","underscoreScriptKey","concat","getBiggestCapacityCell","showTransactionModal","content","updateInfoBox","theInfoBox","tx_status","status","setContent","setType","setTimeout","Metro","infobox","create","onOpen","ib","$","sudtInfoTypeScript","sudtInfoCells","parseSudtInfoData","output_data","toString","FEE_RATIO","SUDT_SMALLEST_CAPACITY","SUDT_INFO_SMALLEST_CAPACITY","TESTNET_SCRIPT_INFO","RICH_NODE_INDEXER_URL","RICH_NODE_RPC_URL","EXPLORER_URL","SUDT_TYPE_SCRIPT","codeHash","hashType","SUDT_CELL_DEP","outPoint","txHash","depType","SUDT_INFO_TYPE_SCRIPT","SUDT_INFO_CELL_DEP","ACP_CELL_DEP","ACP_CODE_HASH","PW_CELL_DEP","PW_CODE_HASH","MAINNET_SCRIPT_INFO","map","reduce","acc","curr","freeCells","number","stringBigInt","padStart","slice","getRawTxTemplate","version","cellDeps","headerDeps","inputs","outputs","outputsData","toUint128Le","uint128","buf","Buffer","from","reverse","readBigUInt128LE","rawHexString","ckbScript","camelCaseScriptKey","script1","script2","stringToHex","string","hexData","bytesData","othersData","symbol","other","split","restInfos","key","CurrencyCandidates","Data","cryptoCoins","unit","icon","legalTenders","isLegalTender","userAgent","navigator","vendor","test","substr","DataService","uri","queryData","callback","httpMethod","activityDialog","activity","open","ajax","url","dataType","contentType","processData","cache","success","textStatus","jqXHR","close","errorThrown","msgError","responseText","ShowError","ajaxData","http","Request","ApiPrefix","Api_Account_ListAll","Api_Account_Save","Api_Currency_ListAll","document","execCommand","err","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","onerror","NetUtility","request","parsedBody","path","str","replace","btoa","encodeURIComponent","match","p1","String","fromCharCode","warn","charms","ids","forEach","toggle","attr","title","notify","cls","msg","milleseconds","toast","element","requestFullscreen","callbackFullScreenChange","addEventListener","location","reload","history","back","text","size","qrContainer","getElementById","QRCode","width","height","AccountViewModel","AccountViewModelBase","api","getAsync","accounts","fitCurrencies","fitAccounts","initVue","ctx","copyAccount","submitTransaction","toggleCard","toggleClass","getIconInfo","theCurrency","afterMetroReady","select","InputUtility","copyToClipboard","initAccountCards","currencies","_","coin","currency","find","cur","currencyId","clone","qrcode","CreateQRCode","idPrefix","cardDiv","frontCard","children","backCard","e","classList","add","remove","i","initQRCodeOfCard","initCardEffect","CurrencyManagerViewModel","findIndex","supported","statusColor","supportCurrency","SinglePageViewModel","a","iconInfo","supportTransfer","username","nickname","avatar","visitorName","visitorAvatar","visitorAddress","visitorCapacity","visitorFree","receiver","vmTransfer","show","initCards","r","keyperingBank","load","addr","KeyperingBank","tryLoadKeyperingInfo","connect","WalletViewModel","updateCurrenciesStatus","accountName","accountAddress","autoGenerateQrcode","addAccount","editAccount","added","qrcodeFile","base64","files","fileToBase64","postData","postAsync","Refresh","PayHub","Core","Models","Tools","ViewModels","Settings","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call"],"mappings":"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","file":"payhub.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vue\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"vue\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PayHub\"] = factory(require(\"vue\"));\n\telse\n\t\troot[\"PayHub\"] = factory(root[\"Vue\"]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE__39__) {\nreturn ","\"use strict\";\r\n\r\nexport default class AppSettings{\r\n    /**\r\n     * Default unit of the local money, legal tender.\r\n     * CNY/USD/HKD/GBP/EUR/JPY/RUB/KRW/...\r\n     */\r\n    public static readonly DefaultUnitOfMoney = \"CNY\";\r\n}","import CKBComponents from '@nervosnetwork/ckb-sdk-core';\nimport { getTransactionSize, addressToScript } from '@nervosnetwork/ckb-sdk-utils';\n//import { createApp } from \"vue\";\nimport { calSudtAmount, combineInputCells, isKeyperingConnected, KeyperingBank, KeyperingUtility, parseBigIntStringNumber, setLocalStorageDecimal, UnderscoreCell } from \"../Impl\";\nimport { UIHelper } from '../Tools';\nimport { ViewModelBase } from \"../ViewModels/ViewModelBase\";\n\nexport class KeyperingTransferViewModel extends ViewModelBase {\n    charmId: string;\n    worker: KeyperingBank;\n\n    constructor(worker: KeyperingBank, eleId = \"charmTransfer\") {\n        super();\n        this.charmId = eleId;\n        this.worker = worker;\n        this.init();\n    }\n\n    init() {\n        const ctx = this;\n        const vueSettings = {\n            data() {\n                return {\n                    coinName: \"\",\n                    coinUnit: \"\",\n                    form: {\n                        toAddress: '',\n                        transferCount: 0,\n                        selfProvide: false\n                    },\n                    // ckb\n                    currentCapicity: \"0\",\n                    // sudt\n                    inputCells: [] as Array<UnderscoreCell>,\n                    fromSudtCells: [] as Array<UnderscoreCell>,\n                    biggestCapacityCell: {} as UnderscoreCell,\n                    isSUDT: false,\n                    canTransferSUDT: false,\n                    originalSudtCount: BigInt(0),\n                    currentSudtCount: \"0\"\n                };\n            },\n            methods: {\n                transfer: function () {\n                    const authToken: string | null = window.localStorage.getItem(KeyperingUtility.Key_AuthToken)\n                    if (!authToken) {\n                        UIHelper.ToastError(\"Keypering: noAuth\");\n                        return;\n                    }\n                }\n            },\n            // setup: async function(){\n            // },\n            mounted: async function () {\n                //await ctx.check(ctx);\n            }\n        };\n        this.app = Vue.createApp(vueSettings).mount(\"#\" + this.charmId);\n    }\n\n    async check(vm: KeyperingTransferViewModel, checkCKB: boolean = true, checkSUDT: boolean = true){\n        const connected = await isKeyperingConnected();\n        if (!connected) {\n            vm.app.currentCapicity = \"0\";\n            vm.app.currentSudtCount = \"0\";\n            return;\n        }\n        if(checkCKB)\n            await vm.checkCKB(vm);\n        if(checkSUDT)\n            await vm.checkSUDT(vm);\n    }\n\n    async checkSUDT(vm: KeyperingTransferViewModel){\n        const inputCells = await combineInputCells();\n        vm.app.inputCells = [...inputCells];\n        if (inputCells.length === 0) {\n            //UIHelper.ToastError(\"errors.noCells\");\n            vm.app.canTransferSUDT = false;\n        }\n        else {\n            vm.app.canTransferSUDT = true;\n            vm.app.biggestCapacityCell = inputCells.shift()!;\n            vm.app.fromSudtCells = inputCells || [];\n            vm.app.originalSudtCount = calSudtAmount(inputCells);\n            setLocalStorageDecimal();\n            const decimal:number = parseInt(window.localStorage.getItem('decimal') || \"8\");\n            vm.app.currentSudtCount = parseBigIntStringNumber(vm.app.originalSudtCount, decimal);\n        }\n    }\n\n    // TODO\n    async checkCKB(vm: KeyperingTransferViewModel){\n        // const inputCells = await combineInputCells();\n        // vm.app.inputCells = [...inputCells];\n        // if (inputCells.length === 0) {\n        //     //UIHelper.ToastError(\"errors.noCells\");\n        //     vm.app.canTransferSUDT = false;\n        // }\n        // else {\n        //     vm.app.canTransferSUDT = true;\n        //     vm.app.biggestCapacityCell = inputCells.shift()!;\n        //     vm.app.fromSudtCells = inputCells || [];\n        //     vm.app.originalSudtCount = calSudtAmount(inputCells);\n        //     setLocalStorageDecimal();\n        //     const decimal:number = parseInt(window.localStorage.getItem('decimal') || \"8\");\n        //     vm.app.currentSudtCount = parseBigIntStringNumber(vm.app.originalSudtCount, decimal);\n        // }\n    }\n\n    async transferCKB(){}\n\n    async transferSUDT(){}\n\n    async show(vm: KeyperingTransferViewModel, coinName: string, coinUnit: string, receiverAddress: string, checkCKB: boolean = true, checkSUDT: boolean = true){\n        await vm.check(vm, checkCKB, checkSUDT);\n\n        UIHelper.ShowCharm(vm.charmId);\n\n        vm.app.coinName = coinName;\n        vm.app.coinUnit = coinUnit;\n        vm.app.isSUDT = coinUnit.toLocaleLowerCase() !== \"ckb\";\n        vm.app.form.toAddress = receiverAddress;\n    }\n\n}","export * from './KeyperingTransferViewModel';","export * from './interfaces';\r\n","import CKBComponents from '@nervosnetwork/ckb-sdk-core'\nimport { KEYPERING_URL, SECP256K1_BLAKE160_CODE_HASH } from './NervosConstants'\nimport { compareScript, underscoreScriptKey, getNetworkConst, calCapacityAmount, parseBigIntStringNumber } from'./NervosParsers'\nimport { UnderscoreScript, AccountList, UnderscoreCell, Account } from './NervosInterfaces';\nimport { getCells, queryAddresses, requestAuth } from './KeyperingRPC';\nimport { KeyperingUtility } from './KeyperingUtility';\nimport { UIHelper } from '../Tools';\n\n\n\nexport class KeyperingBank{\n    account: Account;\n    free = \"0\";\n    capacity = \"0\";\n    loading = false;\n    tokenAmount = \"0\";\n\n    constructor(){}\n\n    async connect(){\n        try {\n            const req = await requestAuth(\"PayHub\");\n            window.localStorage.setItem(KeyperingUtility.Key_AuthToken, req.token);\n            window.localStorage.setItem(KeyperingUtility.Key_NetworkId, req.networkId);\n            console.log(\"Connected with Keypering wallet ^0^\");\n        } catch (error) {\n            console.log(\"Failed to connect with Keypering wallet :(\");\n            UIHelper.ToastError(error);\n        }\n    }\n\n    async load(): Promise<boolean>{\n        const authToken = window.localStorage.getItem(KeyperingUtility.Key_AuthToken);\n        if (!authToken) {\n            UIHelper.ToastMessage(\"Keypering.noAuth\");\n            return false;\n        }\n        // load info by authToken\n        try{\n            const results: AccountList | undefined = await queryAddresses(authToken);\n            if (results === undefined) {\n                UIHelper.ToastError(\"Keypering.noAddress\");\n                return false;\n            }\n            const addresses: Array<Account> = results.addresses;\n            const address = addresses.filter(\n                (address: Account) =>\n                    address.lockScriptMeta.name === \"Secp256k1\"\n                );\n            if (address.length === 0) {\n                UIHelper.ToastError(\"Keypering.no256k1Address\");\n                return false;\n            }\n            this.account = address[0];\n            // 需要缓存吗？\n            window.localStorage.setItem(KeyperingUtility.Key_Address, this.account.address)\n            window.localStorage.setItem(KeyperingUtility.Key_LockHash, this.account.lockHash)\n\n            const lockScript: UnderscoreScript = {\n                code_hash: SECP256K1_BLAKE160_CODE_HASH,\n                hash_type: 'type',\n                args: this.account.lockScript.args\n            };\n            window.localStorage.setItem(\n                KeyperingUtility.Key_LockScript,\n                JSON.stringify(lockScript || {})\n            );\n\n            const cells = await getCells('lock', lockScript);\n            if (cells.length > 0) {\n                const summary = calCapacityAmount(cells);\n                this.free = parseBigIntStringNumber(summary.free) || \"0\";\n                this.capacity = parseBigIntStringNumber(summary.capacity) || \"0\";\n            }\n            UIHelper.ToastMessage(\"Keypering: success.auth\");\n            return true;\n        }\n        catch(error){\n            UIHelper.ToastError(error);\n            return false;\n        }\n    }\n}","import CKBComponents from '@nervosnetwork/ckb-sdk-core'\nimport { UIHelper } from '../Tools'\nimport { KEYPERING_URL } from './NervosConstants'\nimport { getNetworkConst } from './NervosParsers'\nimport { UnderscoreScript, AccountList, UnderscoreCell } from './NervosInterfaces'\n\nexport const requestAuth = async (description: string): Promise<{ token: string, networkId: string }> => {\n  const response = await fetch(KEYPERING_URL, {\n    method: 'POST',\n    body: JSON.stringify({\n      id: 2,\n      jsonrpc: '2.0',\n      method: 'auth',\n      params: {\n        description\n      }\n    })\n  });\n  const data = await response.json();\n  return data.result;\n}\n\nexport const queryAddresses = async (token: string): Promise<AccountList | undefined> => {\n  const response = await fetch(KEYPERING_URL, {\n    method: 'POST',\n    headers: {\n      Authorization: `Bearer ${token}`\n    },\n    body: JSON.stringify({\n      id: 3,\n      jsonrpc: '2.0',\n      method: 'query_addresses'\n    })\n  });\n  const data = await response.json();\n  return data.result;\n}\n\nexport const getCells = async (scriptType: 'lock' | 'type', script: UnderscoreScript): Promise<Array<UnderscoreCell> | []> => {\n  const payload = {\n    id: 1,\n    jsonrpc: '2.0',\n    method: 'get_cells',\n    params: [\n      {\n        script: script,\n        script_type: scriptType\n      },\n      'desc',\n      '0x3e8'\n    ]\n  };\n  const body = JSON.stringify(payload, null, '  ');\n  const response = await fetch(getNetworkConst(\"RICH_NODE_INDEXER_URL\") as string, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body\n  });\n  const data = await response.json();\n  return data.result ? data.result.objects : [];\n}\n\nexport const getTransaction = async (tx: string): Promise<Record<string, Record<string, unknown>> | undefined> => {\n  if (tx === \"\") {\n    return undefined;\n  }\n  const payload = {\n    id: 42,\n    jsonrpc: '2.0',\n    method: 'get_transaction',\n    params: [\n      tx\n    ]\n  };\n  const body = JSON.stringify(payload, null, '  ');\n  const indexerUrl = getNetworkConst(\"RICH_NODE_RPC_URL\") as string;\n  const response = await fetch(indexerUrl, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body\n  });\n  const data = await response.json();\n  return data.result;\n}\n\nexport const signAndSendTransaction = async (rawTransaction: CKBComponents.RawTransactionToSign, token: string, lockHash: string, inputSignConfig = { index: 0, length: -1 }): Promise<Record<string, unknown>> => {\n  rawTransaction.witnesses[0] = {\n    lock: '',\n    inputType: '',\n    outputType: ''\n  };\n  const res = await fetch(KEYPERING_URL, {\n    method: 'POST',\n    headers: {\n      Authorization: `Bearer ${token}`\n    },\n    body: JSON.stringify({\n      id: 1,\n      jsonrpc: '2.0',\n      method: 'sign_and_send_transaction',\n      params: {\n        tx: rawTransaction,\n        description: \"Transaction\",\n        lockHash: lockHash,\n        inputSignConfig: inputSignConfig\n      }\n    })\n  });\n  const response = await res.json();\n  if (response.message) {\n    UIHelper.ToastError(response.message);\n  }\n  return response.result;\n}","import { UIHelper } from \"../Tools\";\nimport { getCells, getTransaction, queryAddresses } from \"./KeyperingRPC\";\nimport { compareScript, underscoreScriptKey, getNetworkConst, parseSudtInfoData } from './NervosParsers'\nimport { UnderscoreScript, UnderscoreCell } from './NervosInterfaces';\n\nexport class KeyperingUtility{\n    static readonly Key_AuthToken = \"keypering.authToken\";\n    static readonly Key_NetworkId = \"keypering.networkId\";\n\n    static readonly Key_Address = \"keypering.address\";\n    static readonly Key_LockHash = \"keypering.lockHash\";\n    static readonly Key_LockScript = \"keypering.lockScript\";\n}\n\nexport const combineInputCells = async (): Promise<Array<UnderscoreCell> | []> => {\n    const lockScript: UnderscoreScript = JSON.parse(window.localStorage.getItem(\"lockScript\") as string);\n    const cells = await getCells('lock', lockScript);\n    if (cells.length === 0) {\n        return [];\n    }\n    const biggestCapacityCell = cells.filter(\n        (cell: UnderscoreCell) => cell.output.type === null).sort(\n            (cell1: UnderscoreCell, cell2: UnderscoreCell) => Number(BigInt(cell2.output.capacity) - BigInt(cell1.output.capacity))\n        )[0];\n\n    const sudtTypeScript = getNetworkConst(\"SUDT_TYPE_SCRIPT\") as CKBComponents.Script;\n    sudtTypeScript.args = window.localStorage.getItem('lockHash') || '';\n    const sudtCells = cells.filter((cell: UnderscoreCell) => { return compareScript(cell.output.type, underscoreScriptKey(sudtTypeScript)) });\n    if (sudtCells.length > 0) {\n        return [biggestCapacityCell].concat(sudtCells);\n    } else {\n        return [];\n    }\n}\n\nexport const getBiggestCapacityCell = async (lockScript: UnderscoreScript): Promise<UnderscoreCell> => {\n    const cells: Array<UnderscoreCell> = await getCells('lock', lockScript);\n    return cells.filter(\n        (cell: UnderscoreCell) => cell.output.type === null).sort(\n            (cell1: UnderscoreCell, cell2: UnderscoreCell) => Number(BigInt(cell2.output.capacity) - BigInt(cell1.output.capacity))\n        )[0];\n}\n\nexport const showTransactionModal = async (tx: string): Promise<void> => {\n    const txLink = getNetworkConst(\"EXPLORER_URL\") + tx;\n    const content = `<p><a href=\"${txLink}\" target=\"_blank\">View the transaction: ${tx}</a></p>`;\n    \n    const updateInfoBox = async (theInfoBox: any) =>{\n        const response = await getTransaction(tx);\n        if (response !== undefined && response?.tx_status?.status === \"committed\") {\n            theInfoBox.setContent(\"<h3>Completed!</h3>\" + content);\n            theInfoBox.setType(\"success\");\n        }\n        else{\n            setTimeout(() => { updateInfoBox(theInfoBox) }, 2000);\n        }\n    };\n    const infoBox = Metro.infobox.create(\n        \"<h3>Pending...</h3>\" + content,\n        \"info\",\n        {\n            onOpen: function () {\n                var ib = $(this).data(\"infobox\");\n                setTimeout(function () {\n                    updateInfoBox(ib);\n                }, 2000);\n            }\n        }\n    );\n}\n\nexport const isKeyperingConnected = async (): Promise<boolean> => {\n    try {\n        const address = await queryAddresses(window.localStorage.getItem(KeyperingUtility.Key_AuthToken) || \"\");\n        if (address === undefined) {\n            UIHelper.ToastError(\"isKeyperingConnected: errors.noAddress\");\n            return false;\n        } else {\n            return true;\n        }\n    } catch (error) {\n        UIHelper.ToastError(error.message);\n        return false;\n    }\n}\n\nexport const setLocalStorageDecimal = async (): Promise<void> => {\n    if (window.localStorage.getItem(\"decimal\") === null) {\n        const sudtInfoTypeScript = getNetworkConst(\"SUDT_INFO_TYPE_SCRIPT\") as CKBComponents.Script;\n        sudtInfoTypeScript.args = window.localStorage.getItem(\"lockHash\") || \"\";\n\n        const sudtInfoCells = await getCells('type', underscoreScriptKey(sudtInfoTypeScript));\n        if (sudtInfoCells.length > 0) {\n            const data = parseSudtInfoData(sudtInfoCells[0].output_data);\n            window.localStorage.setItem('decimal', data.decimal.toString());\n        }\n    }\n}","import CKBComponents from '@nervosnetwork/ckb-sdk-core'\n\nexport const KEYPERING_URL = 'http://localhost:3102';\nexport const SECP256K1_BLAKE160_CODE_HASH = '0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8';\nexport const FEE_RATIO = BigInt(1_000);\nexport const SUDT_SMALLEST_CAPACITY = BigInt(142 * 10 ** 8);\nexport const SUDT_INFO_SMALLEST_CAPACITY = BigInt(169 * 10 ** 8);\nexport const TESTNET_SCRIPT_INFO: { [key: string]: string | CKBComponents.CellDep | CKBComponents.Script } = {\n  RICH_NODE_INDEXER_URL: 'https://testnet.ckbapp.dev/indexer',\n  RICH_NODE_RPC_URL: 'https://testnet.ckbapp.dev/rpc',\n  EXPLORER_URL: \"https://explorer.nervos.org/aggron/transaction/\",\n\n  SUDT_TYPE_SCRIPT: {\n    codeHash: \"0xc5e5dcf215925f7ef4dfaf5f4b4f105bc321c02776d6e7d52a1db3fcd9d011a4\",\n    hashType: 'type',\n    args: \"\"\n  } as CKBComponents.Script,\n  SUDT_CELL_DEP: {\n    outPoint: {\n      txHash: \"0xe12877ebd2c3c364dc46c5c992bcfaf4fee33fa13eebdf82c591fc9825aab769\",\n      index: \"0x0\"\n    },\n    depType: \"code\"\n  } as CKBComponents.CellDep,\n\n  SUDT_INFO_TYPE_SCRIPT: {\n    codeHash: \"0x72f3d72944f29511eedf806d4b12d77ca0a5cfbb2000d059d8898d283971b579\",\n    hashType: 'type',\n    args: \"\"\n  } as CKBComponents.Script,\n  SUDT_INFO_CELL_DEP: {\n    outPoint: {\n      txHash: \"0x81eeaaedc2909faf471cc17f8aeb66dd5e78d50ad1b7eb56e41ab821ee356330\",\n      index: \"0x0\"\n    },\n    depType: \"code\"\n  } as CKBComponents.CellDep,\n\n  ACP_CELL_DEP: {\n    outPoint: {\n      txHash: \"0xec26b0f85ed839ece5f11c4c4e837ec359f5adc4420410f6453b1f6b60fb96a6\",\n      index: \"0x0\"\n    },\n    depType: \"depGroup\"\n  } as CKBComponents.CellDep,\n  ACP_CODE_HASH: \"0x3419a1c09eb2567f6552ee7a8ecffd64155cffe0f1796e6e61ec088d740c1356\",\n\n  PW_CELL_DEP: {\n    outPoint: {\n      txHash: \"0x57a62003daeab9d54aa29b944fc3b451213a5ebdf2e232216a3cfed0dde61b38\",\n      index: \"0x0\"\n    },\n    depType: \"code\"\n  } as CKBComponents.CellDep,\n  PW_CODE_HASH: \"0x58c5f491aba6d61678b7cf7edf4910b1f5e00ec0cde2f42e0abb4fd9aff25a63\"\n};\n\nexport const MAINNET_SCRIPT_INFO: { [key: string]: string | CKBComponents.CellDep | CKBComponents.Script } = {\n  RICH_NODE_INDEXER_URL: 'https://mainnet.ckbapp.dev/indexer',\n  RICH_NODE_RPC_URL: 'https://mainnet.ckbapp.dev/rpc',\n  EXPLORER_URL: \"https://explorer.nervos.org/transaction/\",\n\n  SUDT_TYPE_SCRIPT: {\n    codeHash: \"0x5e7a36a77e68eecc013dfa2fe6a23f3b6c344b04005808694ae6dd45eea4cfd5\",\n    hashType: 'type',\n    args: \"\"\n  } as CKBComponents.Script,\n  SUDT_CELL_DEP: {\n    outPoint: {\n      txHash: \"0xc7813f6a415144643970c2e88e0bb6ca6a8edc5dd7c1022746f628284a9936d5\",\n      index: \"0x0\"\n    },\n    depType: \"code\"\n  } as CKBComponents.CellDep,\n\n  SUDT_INFO_TYPE_SCRIPT: {\n    codeHash: \"0x72f3d72944f29511eedf806d4b12d77ca0a5cfbb2000d059d8898d283971b579\",\n    hashType: 'type',\n    args: \"\"\n  } as CKBComponents.Script,\n  SUDT_INFO_CELL_DEP: {\n    outPoint: {\n      txHash: \"0x81eeaaedc2909faf471cc17f8aeb66dd5e78d50ad1b7eb56e41ab821ee356330\",\n      index: \"0x0\"\n    },\n    depType: \"code\"\n  } as CKBComponents.CellDep,\n\n  ACP_CODE_HASH: \"0xd369597ff47f29fbc0d47d2e3775370d1250b85140c670e4718af712983a2354\",\n  ACP_CELL_DEP: {\n    outPoint: {\n      txHash: '0x4153a2014952d7cac45f285ce9a7c5c0c0e1b21f2d378b82ac1433cb11c25c4d',\n      index: \"0x0\"\n    },\n    depType: \"depGroup\"\n  } as CKBComponents.CellDep,\n\n  PW_CELL_DEP: {\n    outPoint: {\n      txHash: '0x1d60cb8f4666e039f418ea94730b1a8c5aa0bf2f7781474406387462924d15d4',\n      index: \"0x0\"\n    },\n    depType: \"code\"\n  } as CKBComponents.CellDep,\n  PW_CODE_HASH: \"0xbf43c3602455798c1a61a596e0d95278864c552fafe231c063b3fabf97a8febc\"\n};","import CKBComponents from '@nervosnetwork/ckb-sdk-core';\nimport { MAINNET_SCRIPT_INFO, TESTNET_SCRIPT_INFO } from './NervosConstants'\nimport { UnderscoreCell, UnderscoreScript } from './NervosInterfaces'\n\nexport const calCapacityAmount = function (cells: Array<UnderscoreCell>): {free: bigint, capacity: bigint} {\n    const capacity = cells\n      .map(cell => BigInt(cell.output.capacity))\n      .reduce((acc, curr) => acc + curr, BigInt(0));\n  \n    const freeCells = cells.filter(cell => cell.output_data === '0x');\n    let free = BigInt(0); //0n\n    if (freeCells !== undefined) {\n      free = freeCells\n        .map(cell => BigInt(cell.output.capacity))\n        .reduce((acc, curr) => acc + curr, BigInt(0));\n    }\n  \n    return {\n      free,\n      capacity\n    };\n  }\n  \n  export const parseBigIntStringNumber = function (number: bigint, decimal = 8): string {\n    const stringBigInt = number.toString();\n    const length = stringBigInt.length;\n    if (length <= decimal) {\n      return `0.${stringBigInt.padStart(decimal - length, \"0\")}`;\n    } else {\n      return `${stringBigInt.slice(0, length - decimal)}.${stringBigInt.slice(length - decimal)}`;\n    }\n  }\n  \n  export const getRawTxTemplate = (): CKBComponents.RawTransactionToSign => {\n    return {\n      version: '0x0',\n      cellDeps: [\n        getNetworkConst(\"SUDT_CELL_DEP\") as CKBComponents.CellDep\n      ],\n      headerDeps: [],\n      inputs: [],\n      outputs: [],\n      witnesses: [],\n      outputsData: []\n    };\n  }\n  \n  export const toUint128Le = (uint128: bigint): string => {\n    const buf = Buffer.from(uint128.toString(16).padStart(32, '0'), 'hex');\n    return Buffer.concat([buf.slice(16).reverse(), buf.slice(0, 16).reverse()]).toString('hex');\n  }\n  \n  export const readBigUInt128LE = (rawHexString: string): string => {\n    const buf = Buffer.from(rawHexString, 'hex');\n    return buf.reverse().toString('hex');\n  }\n  \n  export const underscoreScriptKey = (ckbScript: CKBComponents.Script): UnderscoreScript => {\n    return { code_hash: ckbScript.codeHash, hash_type: ckbScript.hashType, args: ckbScript.args };\n  }\n  \n  export const camelCaseScriptKey = (ckbScript: UnderscoreScript): CKBComponents.Script => {\n    return { codeHash: ckbScript.code_hash, hashType: ckbScript.hash_type, args: ckbScript.args };\n  }\n  \n  export const compareScript = (script1: UnderscoreScript | null, script2: UnderscoreScript | null): boolean => {\n    if (script1 === null || script2 === null) {\n      return false;\n    }\n    return script1.args === script2.args &&\n      script1.code_hash === script2.code_hash &&\n      script1.hash_type === script2.hash_type;\n  }\n  \n  export const stringToHex = (string: string): string => {\n    return Buffer.from(string).toString('hex');\n  }\n  \n  export const parseSudtInfoData = (hexData: string): { decimal: number, name: string, symbol: string, restInfos: Array<string> } => {\n    const bytesData = Buffer.from(hexData.slice(2), 'hex');\n    const decimal = bytesData[0];\n    const othersData = bytesData.slice(2).toString('utf-8');\n    const [name, symbol, ...other] = othersData.split(\"\\n\");\n    return {\n      decimal: decimal,\n      name: name,\n      symbol: symbol,\n      restInfos: other\n    };\n  }\n  \n  export const calSudtAmount = function(cells: Array<UnderscoreCell>): bigint {\n    const amount = cells\n      .map(cell => BigInt('0x' + readBigUInt128LE(cell.output_data.slice(2, 34))))\n      .reduce((acc, curr) => acc + curr, BigInt(0));\n    return amount;\n  }\n  \n  export const getNetworkConst = (key: string): string | CKBComponents.CellDep | CKBComponents.Script => {\n    return window.localStorage.getItem(\"networkId\") === 'ckb' ? MAINNET_SCRIPT_INFO[key] : TESTNET_SCRIPT_INFO[key];\n  }","export * from \"./NervosConstants\";\nexport * from \"./NervosInterfaces\";\nexport * from \"./NervosParsers\";\n// Keypering\nexport * from \"./KeyperingRPC\";\nexport * from \"./KeyperingUtility\";\nexport * from \"./KeyperingBank\";\n// pw-core\n//export * from './PWCoreBank';","export class Currency{\r\n    id: string;\r\n    name: string;\r\n    unit: string;\r\n\r\n    // ui\r\n    icon: string;\r\n    added: boolean;\r\n    statusColor: string;\r\n}","\"use strict\";\r\nimport AppSettings from \"../AppSettings\";\r\n\r\nexport class CurrencyCandidates{\r\n    public static readonly Data = {\r\n        cryptoCoins: [\r\n            {\r\n                id: \"d023ec040f79f1a9b2ac960b43785089\",\r\n                name: \"Bitcoin\",\r\n                unit: \"BTC\"\r\n            },\r\n            {\r\n                id: \"94195b7b439ec3bda396c8df3d53e0c0\",\r\n                name: \"Ethereum\",\r\n                unit: \"ETH\"\r\n            },\r\n            {\r\n                id: \"116e1fdc7967b296c3b099863cabc22a\",\r\n                name: \"EthereumClassic\",\r\n                unit: \"ETC\"\r\n            },\r\n            {\r\n                id: \"f89e1773f4dd0ab54a474e085896877d\",\r\n                name: \"Litecoin\",\r\n                unit: \"LTC\"\r\n            },\r\n            {\r\n                id: \"091527f0a496d0eafd2754f1b9590aa9\",\r\n                name: \"Nervos\",\r\n                unit: \"CKB\",\r\n                icon: \"pi-ckb\"\r\n            },\r\n            {\r\n                id: \"2c0847f66f16adcc6ddf93f1db5827e7\",\r\n                name: \"Cosmos\",\r\n                unit: \"ATOM\",\r\n                icon: \"pi-atom\"\r\n            },\r\n            {\r\n                id: \"d3428ee9afeb947b67aa37e634148ee5\",\r\n                name: \"EOS\",\r\n                unit: \"EOS\"\r\n            },\r\n            {\r\n                id: \"ad4df7721cbab485e8fc04479aecd7e0\",\r\n                name: \"Zcash\",\r\n                unit: \"ZEC\"\r\n            },\r\n            {\r\n                id: \"0ada0159f6906ac6d4e9634885c06bbc\",\r\n                name: \"Horizen\",\r\n                unit: \"ZEN\",\r\n                icon: \"pi-zen\"\r\n            },\r\n            \r\n            {\r\n                id: \"17e296456ad17014fd9785da82c18a0c\",\r\n                name: \"StellarLumens\",\r\n                unit: \"XLM\"\r\n            },\r\n            {\r\n                id: \"c33eb0623e9324c722c1e0a5d1fdb2a3\",\r\n                name: \"Polkadot\",\r\n                unit: \"DOT\",\r\n                icon: \"pi-dot\"\r\n            },\r\n            {\r\n                id: \"c0062863e3e99f67607ad1ae9a4299a7\",\r\n                name: \"Ripple\",\r\n                unit: \"XRP\"\r\n            },\r\n            {\r\n                id: \"dd48f2c21016915ba6c795f320a4cf83\",\r\n                name: \"TRON\",\r\n                unit: \"TRX\"\r\n            },\r\n            {\r\n                id: \"96678759312f067a9fd622b637502e36\",\r\n                name: \"MakerDAO\",\r\n                unit: \"DAI\",\r\n                icon: \"pi-dai\"\r\n            },\r\n            {\r\n                id: \"23ec191a8c1a7fa3c70c6088cd23e634\",\r\n                name: \"Filecoin\",\r\n                unit: \"FIL\",\r\n                icon: \"pi-fil\"\r\n            }\r\n        ],\r\n        legalTenders: [\r\n            {\r\n                id: \"9b88c95a15e018c3f8038a7d0160145c\",\r\n                name: \"Paypal\",\r\n                unit: AppSettings.DefaultUnitOfMoney,\r\n                isLegalTender: true,\r\n                icon: \"mif-paypal\"\r\n            },\r\n            {\r\n                id: \"92a176f8a430b8b977ffe5fcff601372\",\r\n                name: \"Alipay\",\r\n                unit: AppSettings.DefaultUnitOfMoney,\r\n                isLegalTender: true,\r\n                icon: \"pi-alipay\"\r\n            },\r\n            {\r\n                id: \"c20ff00858b26de6ff99273ec51c18de\",\r\n                name: \"WeChatPay\",\r\n                unit: AppSettings.DefaultUnitOfMoney,\r\n                isLegalTender: true,\r\n                icon: \"pi-wechat\"\r\n            }\r\n        ]\r\n    }\r\n}","import { Currency } from \"./Currency\";\r\n\r\nexport class WithdrawAccount{\r\n    currencyId: string;\r\n    account: string;\r\n\r\n    name: string;\r\n    qrcode: string;\r\n\r\n    theCurrency: Currency;\r\n}","export * from './CurrencyCandidates';\r\nexport * from './Currency';\r\nexport * from './WithdrawAccount';","\"use strict\";\r\n\r\nexport class BrowserUtility {\r\n    public static IsMobileBrowser(): boolean {\r\n        let userAgent: string = navigator.userAgent || navigator.vendor;// || window.opera;\r\n        //(function (a, b) {\r\n        //    if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4)))\r\n        //        window.location = b\r\n        //})(navigator.userAgent || navigator.vendor || window.opera, 'http://detectmobilebrowser.com/mobile');\r\n        if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(userAgent)\r\n            || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(userAgent.substr(0, 4)))\r\n            return true;\r\n        return false;\r\n    }\r\n\r\n}","\"use strict\";\r\n\r\nimport NetUtility from \"./NetUtility\";\r\nimport { UIHelper } from \"./UIHelper\";\r\n\r\nexport class DataService {\r\n    static ApiPrefix = \"/api/v0/\";\r\n    static Api_Account_ListAll = DataService.ApiPrefix + \"account/all\";\r\n    static Api_Account_Save = DataService.ApiPrefix + \"account/save\";\r\n\r\n    static Api_Currency_ListAll = DataService.ApiPrefix + \"currency/all\";\r\n    \r\n\r\n    query(uri: string, queryData: any, callback: Function, httpMethod = \"GET\") {\r\n        const activityDialog = Metro.activity.open({\r\n            type: \"cycle\"\r\n        });\r\n        $.ajax({\r\n            url: uri,\r\n            dataType: \"json\",\r\n            type: httpMethod,\r\n            // https://stackoverflow.com/questions/9870523/differences-in-application-json-and-application-x-www-form-urlencoded\r\n            // https://stackoverflow.com/questions/21578814/how-to-receive-json-as-an-mvc-5-action-method-parameter\r\n            contentType: 'application/x-www-form-urlencoded', // : 'application/json; charset=utf-8',\r\n            // the HttpOnly make the two param invisible in client side script: account.id, account.password\r\n            // data: \"account.id=\" + Cookies.get('account.id') + \"&account.password=\" + Cookies.get('account.password'),\r\n            data: queryData,\r\n            async: true,\r\n            processData: false,\r\n            cache: false,\r\n            success: function (data, textStatus, jqXHR) {\r\n                Metro.activity.close(activityDialog);\r\n                //data = JSON.parse(jqXHR.responseText);\r\n                if (typeof callback === \"function\") {\r\n                    callback(data);\r\n                    return;\r\n                }\r\n            },\r\n            error: function (jqXHR, textStatus, errorThrown) {\r\n                Metro.activity.close(activityDialog);\r\n                const msgError = \"【Status】\" + textStatus + \"【error】\" + errorThrown + \"【others】\" + jqXHR.responseText;\r\n                UIHelper.ShowError(\"ERROR\", msgError);\r\n            }\r\n        });\r\n    }\r\n\r\n    async getAsync(url: string, ajaxData: any) {\r\n        const activityDialog = Metro.activity.open({\r\n            type: \"cycle\"\r\n        });\r\n\r\n        const response = await NetUtility.http<any>(\r\n            new Request(url, {\r\n                method: \"get\",\r\n                //body: ajaxData\r\n            }\r\n            )\r\n        );\r\n        Metro.activity.close(activityDialog);\r\n\r\n        return response;\r\n    }\r\n\r\n    async postAsync(url: string, ajaxData: any) {\r\n        const activityDialog = Metro.activity.open({\r\n            type: \"cycle\"\r\n        });\r\n\r\n        const response = await NetUtility.http<any>(\r\n            new Request(url, {\r\n                method: \"post\",\r\n                body: ajaxData\r\n            }\r\n            )\r\n        );\r\n        Metro.activity.close(activityDialog);\r\n\r\n        return response;\r\n    }\r\n\r\n}","\"use strict\";\r\n\r\nexport class InputUtility {\r\n    public static copyToClipboard() {\r\n        try {\r\n            document.execCommand(\"copy\");\r\n        }\r\n        catch (err) {\r\n            console.log(\"InputUtility.copyToClipboard: \" + err)\r\n        }\r\n    }\r\n\r\n    public static async fileToBase64(file: File) {\r\n        return new Promise<string>((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.readAsDataURL(file);\r\n            reader.onload = () => resolve(reader.result as string);\r\n            reader.onerror = error => reject(error);\r\n        });\r\n    }\r\n\r\n}","\"use strict\";\r\nimport { HttpResponse } from '../Core/interfaces';\r\n// Ref: https://www.carlrippon.com/fetch-with-async-await-and-typescript/\r\n\r\nexport default class NetUtility{\r\n    static async http<T>(\r\n        request: RequestInfo\r\n    ): Promise<HttpResponse<T>> {\r\n        const response: HttpResponse<T> = await fetch(\r\n            request\r\n        );\r\n        response.parsedBody = await response.json();\r\n        return response;\r\n    }\r\n    \r\n    static async get<T>(\r\n        path: string,\r\n        args: RequestInit = { method: \"get\" }\r\n    ): Promise<HttpResponse<T>> {\r\n        return await NetUtility.http<T>(new Request(path, args));\r\n    };\r\n    \r\n    static async post<T>(\r\n        path: string,\r\n        body: any,\r\n        args: RequestInit = { method: \"post\", body: JSON.stringify(body) }\r\n    ): Promise<HttpResponse<T>> {\r\n        return await NetUtility.http<T>(new Request(path, args));\r\n    };\r\n    \r\n    static async put<T>(\r\n        path: string,\r\n        body: any,\r\n        args: RequestInit = { method: \"put\", body: JSON.stringify(body) }\r\n    ): Promise<HttpResponse<T>> {\r\n        return await NetUtility.http<T>(new Request(path, args));\r\n    };\r\n}\r\n\r\n","\"use strict\";\r\n\r\nexport class StringUtility {\r\n    public static EscapeSpecialChars(str: string): string {\r\n        return str.replace(/\\\\n/g, \"\\\\n\")\r\n            .replace(/\\\\'/g, \"\\\\'\")\r\n            .replace(/\\\\\"/g, '\\\\\"')\r\n            .replace(/\\\\&/g, \"\\\\&\")\r\n            .replace(/\\\\r/g, \"\\\\r\")\r\n            .replace(/\\\\t/g, \"\\\\t\")\r\n            .replace(/\\\\b/g, \"\\\\b\")\r\n            .replace(/\\\\f/g, \"\\\\f\");\r\n    }\r\n\r\n    static base64EncodeUnicode(str: string): string {\r\n        if (window\r\n            && \"btoa\" in window\r\n            && \"encodeURIComponent\" in window) {\r\n            return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (match, p1) => {\r\n                return String.fromCharCode((\"0x\" + p1) as any);\r\n            }));\r\n        } else {\r\n            console.warn(\"base64EncodeUnicode requirements: window.btoa and window.encodeURIComponent functions\");\r\n            return null;\r\n        }\r\n    }\r\n\r\n}\r\n","\"use strict\";\r\n\r\nexport class UIHelper {\r\n    //public static charmId: string = \"charm\";\r\n    //public static editAreaIdInCharm: string = \"divEditArea\";\r\n\r\n    public static ShowCharm(id: string) {\r\n        //var charm = $(\"#\" + id).data(\"charms\");\r\n        //charm.open();\r\n        Metro.charms.open(\"#\" + id);\r\n    }\r\n\r\n    public static HideCharm(id: string) {\r\n        //var charm = $(\"#\" + id).data(\"charms\");\r\n        //charm.close();\r\n        Metro.charms.close(\"#\" + id);\r\n    }\r\n\r\n    public static HideCharms(ids: Array<string>) {\r\n        // _.forEach(ids, id => {\r\n        //     Metro.charms.close(\"#\" + id);\r\n        // });\r\n        ids.forEach( id =>{\r\n            Metro.charms.close(\"#\" + id);\r\n        });\r\n    }\r\n\r\n    public static ToggleCharm(id: string) {\r\n        Metro.charms.toggle(\"#\" + id);\r\n    }\r\n\r\n    public static disableElement(id: string) {\r\n        $(\"#\" + id).attr('disabled', \"true\");\r\n    }\r\n\r\n    public static enableElement(id: string) {\r\n        $(\"#\" + id).attr('disabled', \"false\");\r\n    }\r\n\r\n    public static ShowMessage(title: string, message: string) {\r\n        Metro.notify.create(message, title, {\r\n            cls: \"info\"\r\n        });\r\n    }\r\n\r\n    public static ShowError(title: string, error: string) {\r\n        Metro.notify.create(error, title, {\r\n            cls: \"alert\"\r\n        });\r\n    }\r\n\r\n    public static ToastError(msg: string, milleseconds = 5000) {\r\n        const toast = Metro.toast.create;\r\n        toast(msg, null, milleseconds, \"bg-red fg-white\");\r\n    }\r\n\r\n    public static ToastMessage(msg: string, milleseconds = 5000) {\r\n        const toast = Metro.toast.create;\r\n        toast(msg, null, milleseconds, \"bg-green fg-white\");\r\n    }\r\n\r\n\r\n    public static LaunchFullScreen(element: HTMLElement) {\r\n        if (element.requestFullscreen) {\r\n            element.requestFullscreen();\r\n        } \r\n        // else if (element.mozRequestFullScreen) {\r\n        //     element.mozRequestFullScreen();\r\n        // } else if (element.webkitRequestFullscreen) {\r\n        //     element.webkitRequestFullscreen();\r\n        // } else if (element.msRequestFullscreen) {\r\n        //     element.msRequestFullscreen();\r\n        // }\r\n    }\r\n\r\n    public static SetupFullScreen(element: HTMLElement, callbackFullScreenChange: Function) {\r\n        if (element.addEventListener) { // listen to exitFullScreen\r\n            element.addEventListener('webkitfullscreenchange', () => {\r\n                if (callbackFullScreenChange) {\r\n                    callbackFullScreenChange();\r\n                }\r\n            }, false);\r\n            element.addEventListener('mozfullscreenchange', () => {\r\n                if (callbackFullScreenChange) {\r\n                    callbackFullScreenChange();\r\n                }\r\n            }, false);\r\n            element.addEventListener('fullscreenchange', () => {\r\n                if (callbackFullScreenChange) {\r\n                    callbackFullScreenChange();\r\n                }\r\n            }, false);\r\n            element.addEventListener('MSFullscreenChange', () => {\r\n                if (callbackFullScreenChange) {\r\n                    callbackFullScreenChange();\r\n                }\r\n            }, false);\r\n        }\r\n    }\r\n\r\n    public static Refresh() {\r\n        window.location.reload();\r\n        //window.location.href = window.location.href;\r\n    }\r\n\r\n    public static GoBack() {\r\n        window.history.back();\r\n    }\r\n\r\n    public static CreateQRCode(eleId: string, text: string, size=256) {\r\n        const qrContainer = document.getElementById(eleId);\r\n        if (qrContainer) {\r\n            const qrc = new QRCode(qrContainer, {\r\n                text: text,\r\n                width: size,\r\n                height: size\r\n            });\r\n        }\r\n    }\r\n\r\n}","export * from './BrowserUtility';\r\nexport * from './DataService';\r\nexport * from './InputUtility';\r\nexport * from './NetUtility';\r\nexport * from './StringUtility';\r\nexport * from './UIHelper';","import {DataService, InputUtility} from '../Tools';\r\nimport { createApp } from \"vue\";\r\nimport { AccountViewModelBase } from './AccountViewModelBase';\r\n\r\n\"use strict\";\r\n\r\nexport class AccountViewModel extends AccountViewModelBase {\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    async init() {\r\n        const data = await this.api.getAsync(DataService.Api_Account_ListAll, {});\r\n        this.accounts = data.parsedBody;\r\n\r\n        this.fitCurrencies();\r\n        this.fitAccounts();\r\n        this.initVue();\r\n    }\r\n\r\n    initVue() {\r\n        const ctx = this;\r\n        const vueSettings = {\r\n            data(){\r\n                return {\r\n                    accounts: ctx.accounts\r\n                };\r\n            },\r\n            methods: {\r\n                copyAccount: function (index: number) {\r\n                    ctx.copyAccount(index);\r\n                },\r\n                submitTransaction: function (index: number) {\r\n                    const account = ctx.accounts[index];\r\n                    //\r\n                },\r\n                toggleCard: function (index: number) {\r\n                    $('#card_' + index).toggleClass('active');\r\n                },\r\n                getIconInfo: function(index: number) {\r\n                    const account = ctx.accounts[index];\r\n                    return \"<span class='\"+ account.theCurrency.icon + \"'></span>\";\r\n                }\r\n            },\r\n            mounted: function () {\r\n                Metro.init();\r\n                ctx.afterMetroReady();\r\n            }\r\n        };\r\n        this.app = createApp(vueSettings).mount('#app');\r\n    }\r\n\r\n    copyAccount(index: number) {\r\n        const ele = document.getElementById(\"taAccount_\" + index) as HTMLTextAreaElement;\r\n        ele.select();\r\n\r\n        InputUtility.copyToClipboard();\r\n    }\r\n\r\n    afterMetroReady() {\r\n        this.initAccountCards();\r\n    }\r\n\r\n}","import { Currency, WithdrawAccount, CurrencyCandidates } from '../Models';\r\nimport {UIHelper} from '../Tools';\r\nimport { ViewModelBase } from './ViewModelBase';\r\n\r\n\"use strict\";\r\n\r\nexport class AccountViewModelBase extends ViewModelBase {\r\n    app: any;\r\n\r\n    accounts: Array<WithdrawAccount>;\r\n    currencies: Array<Currency>;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.currencies =_.concat(CurrencyCandidates.Data.cryptoCoins, CurrencyCandidates.Data.legalTenders);\r\n    }\r\n\r\n    fitCurrencies() {\r\n        this.currencies.forEach(coin => {\r\n            if(!coin.icon ){\r\n                coin.icon = \"cc \" + coin.unit;\r\n            }\r\n        });\r\n    }\r\n    \r\n    fitAccounts(){\r\n        this.accounts.forEach(account => {\r\n            const currency = this.currencies.find(cur => account.currencyId === cur.id);\r\n            account.theCurrency = _.clone(currency);\r\n        });\r\n    }\r\n\r\n    initQRCodeOfCard(index: number, data: any) {\r\n        if(data.qrcode && data.qrcode.length > 4)\r\n            return;\r\n        UIHelper.CreateQRCode(\"qrcode_\" + index, data.account, 200);\r\n    }\r\n\r\n    initCardEffect(index: number, idPrefix = \"card_\") {\r\n        if (index < 0)\r\n            return;\r\n        const cardDiv = document.getElementById(idPrefix + index);\r\n        const frontCard = cardDiv.children[0].children[0] as HTMLDivElement;\r\n        const backCard = cardDiv.children[1].children[0] as HTMLDivElement;\r\n\r\n        cardDiv.addEventListener('mouseenter', e => {\r\n            frontCard.classList.add(\"shadow-1\");\r\n            backCard.classList.add(\"shadow-1\");\r\n        });\r\n\r\n        cardDiv.addEventListener('mouseleave', e => {\r\n            frontCard.classList.remove(\"shadow-1\");\r\n            backCard.classList.remove(\"shadow-1\");\r\n        });\r\n    }\r\n\r\n    initAccountCards(){\r\n        for (let i = 0; i < this.accounts.length; i++) {\r\n            const account = this.accounts[i];\r\n            this.initQRCodeOfCard(i, account);\r\n            this.initCardEffect(i);\r\n        }\r\n    }\r\n\r\n}","import { Currency, CurrencyCandidates } from '../Models';\r\nimport {DataService} from '../Tools';\r\nimport { createApp } from \"vue\";\r\nimport { ViewModelBase } from './ViewModelBase';\r\n\r\n\"use strict\";\r\n\r\nexport class CurrencyManagerViewModel extends ViewModelBase {\r\n    app: any;\r\n\r\n    currencies: Array<Currency>;\r\n\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n    async init() {\r\n        //const ctx = this;\r\n        //const data = this.api.getAsync(DataService.Api_AccountCurrencies, {}).then(res => {\r\n        //    console.log(res);\r\n        //    ctx.initVue(res);\r\n        //});\r\n\r\n        const data = await this.api.getAsync(DataService.Api_Account_ListAll, {});\r\n        this.currencies = data.parsedBody;\r\n        this.initVue();\r\n    }\r\n\r\n    initVue() {\r\n        const ctx = this;\r\n        const data =_.concat(CurrencyCandidates.Data.cryptoCoins, CurrencyCandidates.Data.legalTenders);\r\n        _.forEach(data, (coin: any) => {\r\n            coin.icon = \"cc \" + coin.unit;\r\n            const index = ctx.currencies.findIndex(cur => cur.id === coin.id);\r\n            coin.supported = (index >= 0);\r\n            coin.statusColor = index < 0 ? \"cyan\" : \"green\";\r\n        });\r\n        \r\n        const vueSettings = {\r\n            data(){\r\n                return {\r\n                    accounts: data\r\n                };\r\n            },\r\n            methods: {\r\n                supportCurrency: function (index: number) {\r\n                    //ctx.copyAccount(index);\r\n                },\r\n                // toggleCard: function (index) {\r\n                //     $('#card_' + index).toggleClass('active');\r\n                // }\r\n            },\r\n            mounted: function () {\r\n                Metro.init();\r\n                ctx.afterMetroReady();\r\n            }\r\n        };\r\n        this.app = createApp(vueSettings).mount('#app');\r\n    }\r\n\r\n    // copyAccount(index) {\r\n    //     const ele = document.getElementById(\"taAccount_\" + index) as HTMLTextAreaElement;\r\n    //     ele.select();\r\n    //     InputUtility.copyToClipboard();\r\n    // }\r\n\r\n    afterMetroReady() {\r\n    }\r\n\r\n}","import { InputUtility, UIHelper } from \"../Tools\";\r\nimport { ViewModelBase } from \"./ViewModelBase\";\r\n//import { PWCoreBank } from \"../Impl/CKBBank\";\r\n//import { createApp } from \"vue\";\r\nimport { KeyperingBank } from \"../Impl\";\r\nimport { KeyperingTransferViewModel } from \"../Components\";\r\n\r\nexport class SinglePageViewModel extends ViewModelBase {\r\n    //readonly CharmId_charmTransfer = \"charmTransfer\";\r\n    bank: any;//PWCoreBank;\r\n    keyperingBank: KeyperingBank;\r\n    vmTransfer: KeyperingTransferViewModel;\r\n\r\n    constructor(eleId: string, data: any){\r\n        super();\r\n        this.init(eleId, data);\r\n    }\r\n\r\n    init(eleId: string, data: any){\r\n        data.accounts.forEach((a: any) => {\r\n            a.iconInfo = \"<span class='cc \" + a.theCurrency.unit + \"'></span>\";\r\n            a.supportTransfer = false;\r\n        });\r\n\r\n        const ctx = this;\r\n        const vueSettings = {\r\n            data(){\r\n                return {\r\n                    // 主人信息\r\n                    username: data.username,\r\n                    nickname: data.nickname,\r\n                    avatar: data.avatar,\r\n                    accounts: data.accounts,\r\n                    // 访客信息\r\n                    visitorName: \"n/a\",\r\n                    visitorAvatar: \"https://robohash.org/payhub.png\",\r\n                    visitorAddress: \"n/a\",\r\n                    visitorCapacity: 0,\r\n                    visitorFree: 0\r\n                };\r\n            },\r\n            methods: {\r\n                copyAccount: function (index: number) {\r\n                    const ele = document.getElementById(\"taAccount_\" + index) as HTMLTextAreaElement;\r\n                    ele.select();\r\n\r\n                    InputUtility.copyToClipboard();\r\n                },\r\n                transfer: function(index: number) {\r\n                    const receiver = this.accounts[index];\r\n                    ctx.vmTransfer.show(ctx.vmTransfer, receiver.theCurrency.name, receiver.theCurrency.unit, receiver.account);\r\n                },\r\n                toggleCard: function (index: number) {\r\n                    $('#card_' + index).toggleClass('active');\r\n                }\r\n            },\r\n            mounted: async function () {\r\n                Metro.init();\r\n                ctx.initCards(this.accounts);\r\n                //ctx.initBanks(ctx);\r\n            }\r\n        };\r\n        this.app = Vue.createApp(vueSettings).mount('#' + eleId);\r\n    }\r\n\r\n    initCards(accounts: any){\r\n        for (let i = 0; i < accounts.length; i++) {\r\n            const account = accounts[i];\r\n            // mouse enter/leave: flip-card > front(0)/back(1) > card\r\n            const cardDiv = document.getElementById(\"card_\" + i);\r\n            const frontCard = cardDiv.children[0].children[0];\r\n            const backCard = cardDiv.children[1].children[0];\r\n            cardDiv.addEventListener('mouseenter', e => {\r\n                frontCard.classList.add(\"shadow-1\");\r\n                backCard.classList.add(\"shadow-1\");\r\n            });\r\n            cardDiv.addEventListener('mouseleave', e => {\r\n                frontCard.classList.remove(\"shadow-1\");\r\n                backCard.classList.remove(\"shadow-1\");\r\n            });\r\n            // qrcode\r\n            if(account.qrcode && account.qrcode.length > 4)\r\n                continue;\r\n            UIHelper.CreateQRCode(\"qrcode_\" + i, account.account, 200);\r\n        }\r\n    }\r\n\r\n    async tryLoadKeyperingInfo(): Promise<boolean> {\r\n        const r = await this.keyperingBank.load();\r\n        if(r && this.keyperingBank.account){\r\n            const addr = this.keyperingBank.account.address;\r\n            this.app.visitorName = \"You\";\r\n            this.app.visitorAvatar = `https://robohash.org/${addr}.png`;\r\n            this.app.visitorAddress = addr;\r\n            this.app.visitorCapacity = this.keyperingBank.capacity;\r\n            this.app.visitorFree = this.keyperingBank.free;\r\n\r\n            const index = this.app.accounts.findIndex((a: any) => a.theCurrency.unit.toLocaleLowerCase() === \"ckb\" );\r\n            if(index >= 0){\r\n                this.app.accounts[index].supportTransfer = true;\r\n            }\r\n        }\r\n        return r;\r\n    }\r\n\r\n    // async connectPW(){\r\n    //     const activityDialog = Metro.activity.open({\r\n    //         type: \"cycle\"\r\n    //     });\r\n    //     this.bank = new PWCoreBank();\r\n    //     this.bank.init()\r\n    //         .then(() =>{\r\n    //             console.log(\"PWCoreBank is ready.\");\r\n    //         })\r\n    //         .catch(() => {\r\n    //             console.log(\"Some error occured when PWCoreBank is initializing!\");\r\n    //         })\r\n    //         .finally(() =>{\r\n    //             Metro.activity.close(activityDialog);\r\n    //         });\r\n    // }\r\n\r\n    async connectKeypering(){\r\n        const activityDialog = Metro.activity.open({\r\n            type: \"cycle\"\r\n        });\r\n        try{\r\n            if(!this.keyperingBank)\r\n                this.keyperingBank = new KeyperingBank();\r\n            if(!this.vmTransfer)\r\n                this.vmTransfer = new KeyperingTransferViewModel(this.keyperingBank);\r\n            const hasData = await this.tryLoadKeyperingInfo();\r\n            if(!hasData) {\r\n                await this.keyperingBank.connect();\r\n                await this.tryLoadKeyperingInfo();\r\n            }\r\n        }\r\n        finally{\r\n            Metro.activity.close(activityDialog);\r\n        }\r\n    }\r\n\r\n}","\"use strict\";\r\nimport { DataService } from \"../Tools\";\r\n\r\nexport class ViewModelBase {\r\n    app: any;\r\n    api: DataService;\r\n\r\n    constructor() {\r\n        this.api = new DataService();\r\n    }\r\n\r\n}","import { createApp } from \"vue\";\r\nimport {DataService} from '../Tools';\r\nimport {UIHelper, InputUtility} from '../Tools';\r\nimport { AccountViewModelBase } from './AccountViewModelBase';\r\n\r\n\"use strict\";\r\n\r\nexport class WalletViewModel extends AccountViewModelBase {\r\n    constructor() {\r\n        super();\r\n\r\n    }\r\n\r\n    async init() {\r\n        const data = await this.api.getAsync(DataService.Api_Account_ListAll, {});\r\n        this.accounts = data.parsedBody;\r\n        \r\n        this.updateCurrenciesStatus();\r\n        this.fitCurrencies();\r\n        this.fitAccounts();\r\n        this.initVue();\r\n    }\r\n\r\n    initVue() {\r\n        const ctx = this;\r\n        const vueSettings = {\r\n            data(){\r\n                return {\r\n                    accounts: this.accounts,\r\n                    currencies: this.currencies,\r\n                    // account\r\n                    theCurrency: {},\r\n                    accountName: \"\",\r\n                    accountAddress: \"\",\r\n                    autoGenerateQrcode: true\r\n                };\r\n            },\r\n            methods: {\r\n                addAccount: function (index: number) {\r\n                    const currency = this.currencies[index];\r\n                    this.theCurrency = currency;\r\n                    this.accountName = currency.name + \"(\" + currency.unit + \")\";\r\n                    this.accountAddress = \"\";\r\n                    UIHelper.ShowCharm(\"charmEditAccount\");\r\n                },\r\n                editAccount: function (index: number) {\r\n                    const account = this.accounts[index];\r\n                    this.theCurrency = ctx.currencies.find(i => i.id === account.currencyId);\r\n                    this.accountName = account.name;\r\n                    this.accountAddress = account.account;\r\n                    UIHelper.ShowCharm(\"charmEditAccount\");\r\n                },\r\n                toggleCard: function (index: number) {\r\n                    $('#card_' + index).toggleClass('active');\r\n                },\r\n                getIconInfo: function(index: number) {\r\n                    const account = ctx.accounts[index];\r\n                    return \"<span class='\"+ account.theCurrency.icon + \"'></span>\";\r\n                }\r\n            },\r\n            mounted: function () {\r\n                Metro.init();\r\n                ctx.afterMetroReady();\r\n            }\r\n        };\r\n        this.app = createApp(vueSettings).mount('#app');\r\n    }\r\n\r\n    updateCurrenciesStatus(){\r\n        this.currencies.forEach(coin => {\r\n            const index = this.accounts.findIndex(account => account.currencyId === coin.id);\r\n            coin.added = (index >= 0);\r\n            coin.statusColor = index < 0 ? \"cyan\" : \"green\";\r\n        });\r\n    }\r\n\r\n    async saveAccount(){\r\n        const ctx = this;\r\n        const qrcodeFile = document.getElementById(\"qrcodeFile\") as HTMLInputElement;\r\n        let base64 = \"\";\r\n        if(qrcodeFile.files.length > 0){\r\n            base64 = await InputUtility.fileToBase64(qrcodeFile.files[0]);//.catch(e => Error(e));\r\n        }\r\n\r\n        const postData = {\r\n            currencyId: ctx.app.theCurrency.id,\r\n            name: ctx.app.accountName,\r\n            address: ctx.app.accountAddress,\r\n            qrcode: base64\r\n        };\r\n        const res = await this.api.postAsync(DataService.Api_Account_Save, JSON.stringify(postData));\r\n        const data = res.parsedBody;\r\n        if(data && data.id && data.id.length === 32){\r\n            UIHelper.ToastMessage(\"Saved!\");\r\n            UIHelper.Refresh();\r\n        }\r\n        else{\r\n            UIHelper.ToastError(\"Unkown Error!\");\r\n        }\r\n    }\r\n\r\n    afterMetroReady() {\r\n        this.initAccountCards();\r\n    }\r\n\r\n}","export * from './ViewModelBase';\r\nexport * from './AccountViewModelBase';\r\nexport * from './AccountViewModel';\r\nexport * from './CurrencyManagerViewModel';\r\nexport * from './WalletViewModel';\r\nexport * from './SinglePageViewModel';","\"use strict\";\r\n\r\n//import PWCore from './core';\r\n\r\nimport * as core from './Core';\r\n// export {core};\r\n\r\n// export * from './Extensions';\r\n// export * from './Impl';\r\nimport * as models from './Models';\r\n// export {models};\r\n\r\nimport * as tools from './Tools';\r\n// export {tools};\r\n\r\nimport * as viewmodels from './ViewModels';\r\n// export {viewmodels};\r\n\r\nimport * as settings from './AppSettings';\r\n// export {settings};\r\n\r\n//export default PWCore;\r\nconst PayHub = {\r\n    Core: core,\r\n    Models: models,\r\n    Tools: tools,\r\n    ViewModels: viewmodels,\r\n    Settings: settings\r\n}\r\n\r\nexport default PayHub;","module.exports = __WEBPACK_EXTERNAL_MODULE__39__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(607);\n"],"sourceRoot":""}