!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define(["vue"],t):"object"==typeof exports?exports.PayHub=t(require("vue")):e.PayHub=t(e.Vue)}(self,(function(e){return(()=>{"use strict";var t={290:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class a{}t.default=a,a.DefaultUnitOfMoney="CNY"},163:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),o=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),o(a(207),t)},207:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},47:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyperingBank=void 0;const n=a(591),o=a(996),c=a(814),i=a(490),r=a(316);t.KeyperingBank=class{constructor(){this.free="0",this.capacity="0",this.loading=!1,this.tokenAmount="0"}async connect(){try{const e=await c.requestAuth("PayHub");window.localStorage.setItem(i.KeyperingUtility.Key_AuthToken,e.token),window.localStorage.setItem(i.KeyperingUtility.Key_NetworkId,e.networkId),console.log("Connected with Keypering wallet ^0^")}catch(e){console.log("Failed to connect with Keypering wallet :("),r.UIHelper.ToastError(e)}}async load(){const e=window.localStorage.getItem(i.KeyperingUtility.Key_AuthToken);if(!e)return r.UIHelper.ToastMessage("Keypering.noAuth"),!1;try{const t=await c.queryAddresses(e);if(void 0===t)return r.UIHelper.ToastError("Keypering.noAddress"),!1;const a=t.addresses.filter((e=>"Secp256k1"===e.lockScriptMeta.name));if(0===a.length)return r.UIHelper.ToastError("Keypering.no256k1Address"),!1;this.account=a[0],window.localStorage.setItem(i.KeyperingUtility.Key_Address,this.account.address),window.localStorage.setItem(i.KeyperingUtility.Key_LockHash,this.account.lockHash);const s={code_hash:n.SECP256K1_BLAKE160_CODE_HASH,hash_type:"type",args:this.account.lockScript.args};window.localStorage.setItem(i.KeyperingUtility.Key_LockScript,JSON.stringify(s||{}));const d=await c.getCells("lock",s);if(d.length>0){const e=o.calCapacityAmount(d);this.free=o.parseBigIntStringNumber(e.free)||"0",this.capacity=o.parseBigIntStringNumber(e.capacity)||"0"}return r.UIHelper.ToastMessage("Keypering: success.auth"),!0}catch(e){return r.UIHelper.ToastError(e),!1}}}},814:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.signAndSendTransaction=t.getTransaction=t.getCells=t.queryAddresses=t.requestAuth=void 0;const n=a(316),o=a(591),c=a(996);t.requestAuth=async e=>{const t=await fetch(o.KEYPERING_URL,{method:"POST",body:JSON.stringify({id:2,jsonrpc:"2.0",method:"auth",params:{description:e}})});return(await t.json()).result},t.queryAddresses=async e=>{const t=await fetch(o.KEYPERING_URL,{method:"POST",headers:{Authorization:`Bearer ${e}`},body:JSON.stringify({id:3,jsonrpc:"2.0",method:"query_addresses"})});return(await t.json()).result},t.getCells=async(e,t)=>{const a={id:1,jsonrpc:"2.0",method:"get_cells",params:[{script:t,script_type:e},"desc","0x3e8"]},n=JSON.stringify(a,null,"  "),o=await fetch(c.getNetworkConst("RICH_NODE_INDEXER_URL"),{method:"POST",headers:{"Content-Type":"application/json"},body:n});return(await o.json()).result.objects},t.getTransaction=async e=>{if(""===e)return;const t={id:42,jsonrpc:"2.0",method:"get_transaction",params:[e]},a=JSON.stringify(t,null,"  "),n=c.getNetworkConst("RICH_NODE_RPC_URL"),o=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:a});return(await o.json()).result},t.signAndSendTransaction=async(e,t,a,c={index:0,length:-1})=>{e.witnesses[0]={lock:"",inputType:"",outputType:""};const i=await fetch(o.KEYPERING_URL,{method:"POST",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({id:1,jsonrpc:"2.0",method:"sign_and_send_transaction",params:{tx:e,description:"Transaction",lockHash:a,inputSignConfig:c}})}),r=await i.json();return r.message&&n.UIHelper.ToastError(r.message),r.result}},490:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setLocalStorageDecimal=t.isKeyperingConnected=t.showTransactionModal=t.getBiggestCapacityCell=t.combineInputCells=t.KeyperingUtility=void 0;const n=a(316),o=a(814),c=a(996);class i{}t.KeyperingUtility=i,i.Key_AuthToken="keypering.authToken",i.Key_NetworkId="keypering.networkId",i.Key_Address="keypering.address",i.Key_LockHash="keypering.lockHash",i.Key_LockScript="keypering.lockScript",t.combineInputCells=async()=>{const e=JSON.parse(window.localStorage.getItem("lockScript")),t=await o.getCells("lock",e);if(0===t.length)return[];const a=t.filter((e=>null===e.output.type)).sort(((e,t)=>Number(BigInt(t.output.capacity)-BigInt(e.output.capacity))))[0],n=c.getNetworkConst("SUDT_TYPE_SCRIPT");n.args=window.localStorage.getItem("lockHash")||"";const i=t.filter((e=>c.compareScript(e.output.type,c.underscoreScriptKey(n))));return i.length>0?[a].concat(i):[]},t.getBiggestCapacityCell=async e=>(await o.getCells("lock",e)).filter((e=>null===e.output.type)).sort(((e,t)=>Number(BigInt(t.output.capacity)-BigInt(e.output.capacity))))[0],t.showTransactionModal=async e=>{const t=`<p><a href="${c.getNetworkConst("EXPLORER_URL")+e}" target="_blank">View the transaction: ${e}</a></p>`,a=async n=>{var c;const i=await o.getTransaction(e);void 0!==i&&"committed"===(null===(c=null==i?void 0:i.tx_status)||void 0===c?void 0:c.status)?(n.setContent("<h3>Completed!</h3>"+t),n.setType("success")):setTimeout((()=>{a(n)}),2e3)};Metro.infobox.create("<h3>Pending...</h3>"+t,"info",{onOpen:function(){var e=$(this).data("infobox");setTimeout((function(){a(e)}),2e3)}})},t.isKeyperingConnected=async()=>{try{return void 0!==await o.queryAddresses(window.localStorage.getItem(i.Key_AuthToken)||"")||(n.UIHelper.ToastError("isKeyperingConnected: errors.noAddress"),!1)}catch(e){return n.UIHelper.ToastError(e.message),!1}},t.setLocalStorageDecimal=async()=>{if(null===window.localStorage.getItem("decimal")){const e=c.getNetworkConst("SUDT_INFO_TYPE_SCRIPT");e.args=window.localStorage.getItem("lockHash")||"";const t=await o.getCells("type",c.underscoreScriptKey(e));if(t.length>0){const e=c.parseSudtInfoData(t[0].output_data);window.localStorage.setItem("decimal",e.decimal.toString())}}}},591:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MAINNET_SCRIPT_INFO=t.TESTNET_SCRIPT_INFO=t.SUDT_INFO_SMALLEST_CAPACITY=t.SUDT_SMALLEST_CAPACITY=t.FEE_RATIO=t.SECP256K1_BLAKE160_CODE_HASH=t.KEYPERING_URL=void 0,t.KEYPERING_URL="http://localhost:3102",t.SECP256K1_BLAKE160_CODE_HASH="0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8",t.FEE_RATIO=BigInt(1e3),t.SUDT_SMALLEST_CAPACITY=BigInt(142*10**8),t.SUDT_INFO_SMALLEST_CAPACITY=BigInt(169*10**8),t.TESTNET_SCRIPT_INFO={RICH_NODE_INDEXER_URL:"https://testnet.ckbapp.dev/indexer",RICH_NODE_RPC_URL:"https://testnet.ckbapp.dev/rpc",EXPLORER_URL:"https://explorer.nervos.org/aggron/transaction/",SUDT_TYPE_SCRIPT:{codeHash:"0xc5e5dcf215925f7ef4dfaf5f4b4f105bc321c02776d6e7d52a1db3fcd9d011a4",hashType:"type",args:""},SUDT_CELL_DEP:{outPoint:{txHash:"0xe12877ebd2c3c364dc46c5c992bcfaf4fee33fa13eebdf82c591fc9825aab769",index:"0x0"},depType:"code"},SUDT_INFO_TYPE_SCRIPT:{codeHash:"0x72f3d72944f29511eedf806d4b12d77ca0a5cfbb2000d059d8898d283971b579",hashType:"type",args:""},SUDT_INFO_CELL_DEP:{outPoint:{txHash:"0x81eeaaedc2909faf471cc17f8aeb66dd5e78d50ad1b7eb56e41ab821ee356330",index:"0x0"},depType:"code"},ACP_CELL_DEP:{outPoint:{txHash:"0xec26b0f85ed839ece5f11c4c4e837ec359f5adc4420410f6453b1f6b60fb96a6",index:"0x0"},depType:"depGroup"},ACP_CODE_HASH:"0x3419a1c09eb2567f6552ee7a8ecffd64155cffe0f1796e6e61ec088d740c1356",PW_CELL_DEP:{outPoint:{txHash:"0x57a62003daeab9d54aa29b944fc3b451213a5ebdf2e232216a3cfed0dde61b38",index:"0x0"},depType:"code"},PW_CODE_HASH:"0x58c5f491aba6d61678b7cf7edf4910b1f5e00ec0cde2f42e0abb4fd9aff25a63"},t.MAINNET_SCRIPT_INFO={RICH_NODE_INDEXER_URL:"https://mainnet.ckbapp.dev/indexer",RICH_NODE_RPC_URL:"https://mainnet.ckbapp.dev/rpc",EXPLORER_URL:"https://explorer.nervos.org/transaction/",SUDT_TYPE_SCRIPT:{codeHash:"0x5e7a36a77e68eecc013dfa2fe6a23f3b6c344b04005808694ae6dd45eea4cfd5",hashType:"type",args:""},SUDT_CELL_DEP:{outPoint:{txHash:"0xc7813f6a415144643970c2e88e0bb6ca6a8edc5dd7c1022746f628284a9936d5",index:"0x0"},depType:"code"},SUDT_INFO_TYPE_SCRIPT:{codeHash:"0x72f3d72944f29511eedf806d4b12d77ca0a5cfbb2000d059d8898d283971b579",hashType:"type",args:""},SUDT_INFO_CELL_DEP:{outPoint:{txHash:"0x81eeaaedc2909faf471cc17f8aeb66dd5e78d50ad1b7eb56e41ab821ee356330",index:"0x0"},depType:"code"},ACP_CODE_HASH:"0xd369597ff47f29fbc0d47d2e3775370d1250b85140c670e4718af712983a2354",ACP_CELL_DEP:{outPoint:{txHash:"0x4153a2014952d7cac45f285ce9a7c5c0c0e1b21f2d378b82ac1433cb11c25c4d",index:"0x0"},depType:"depGroup"},PW_CELL_DEP:{outPoint:{txHash:"0x1d60cb8f4666e039f418ea94730b1a8c5aa0bf2f7781474406387462924d15d4",index:"0x0"},depType:"code"},PW_CODE_HASH:"0xbf43c3602455798c1a61a596e0d95278864c552fafe231c063b3fabf97a8febc"}},895:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},996:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNetworkConst=t.calSudtAmount=t.parseSudtInfoData=t.stringToHex=t.compareScript=t.camelCaseScriptKey=t.underscoreScriptKey=t.readBigUInt128LE=t.toUint128Le=t.getRawTxTemplate=t.parseBigIntStringNumber=t.calCapacityAmount=void 0;const n=a(591);t.calCapacityAmount=function(e){const t=e.map((e=>BigInt(e.output.capacity))).reduce(((e,t)=>e+t),BigInt(0)),a=e.filter((e=>"0x"===e.output_data));let n=BigInt(0);return void 0!==a&&(n=a.map((e=>BigInt(e.output.capacity))).reduce(((e,t)=>e+t),BigInt(0))),{free:n,capacity:t}},t.parseBigIntStringNumber=function(e,t=8){const a=e.toString(),n=a.length;return n<=t?`0.${a.padStart(t-n,"0")}`:`${a.slice(0,n-t)}.${a.slice(n-t)}`},t.getRawTxTemplate=()=>({version:"0x0",cellDeps:[t.getNetworkConst("SUDT_CELL_DEP")],headerDeps:[],inputs:[],outputs:[],witnesses:[],outputsData:[]}),t.toUint128Le=e=>{const t=Buffer.from(e.toString(16).padStart(32,"0"),"hex");return Buffer.concat([t.slice(16).reverse(),t.slice(0,16).reverse()]).toString("hex")},t.readBigUInt128LE=e=>Buffer.from(e,"hex").reverse().toString("hex"),t.underscoreScriptKey=e=>({code_hash:e.codeHash,hash_type:e.hashType,args:e.args}),t.camelCaseScriptKey=e=>({codeHash:e.code_hash,hashType:e.hash_type,args:e.args}),t.compareScript=(e,t)=>null!==e&&null!==t&&e.args===t.args&&e.code_hash===t.code_hash&&e.hash_type===t.hash_type,t.stringToHex=e=>Buffer.from(e).toString("hex"),t.parseSudtInfoData=e=>{const t=Buffer.from(e.slice(2),"hex"),a=t[0],n=t.slice(2).toString("utf-8"),[o,c,...i]=n.split("\n");return{decimal:a,name:o,symbol:c,restInfos:i}},t.calSudtAmount=function(e){return e.map((e=>BigInt("0x"+t.readBigUInt128LE(e.output_data.slice(2,34))))).reduce(((e,t)=>e+t),BigInt(0))},t.getNetworkConst=e=>"ckb"===window.localStorage.getItem("networkId")?n.MAINNET_SCRIPT_INFO[e]:n.TESTNET_SCRIPT_INFO[e]},448:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),o=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),o(a(591),t),o(a(895),t),o(a(996),t),o(a(814),t),o(a(490),t),o(a(47),t)},545:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Currency=void 0,t.Currency=class{}},340:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CurrencyCandidates=void 0;const o=n(a(290));class c{}t.CurrencyCandidates=c,c.Data={cryptoCoins:[{id:"d023ec040f79f1a9b2ac960b43785089",name:"Bitcoin",unit:"BTC"},{id:"94195b7b439ec3bda396c8df3d53e0c0",name:"Ethereum",unit:"ETH"},{id:"116e1fdc7967b296c3b099863cabc22a",name:"EthereumClassic",unit:"ETC"},{id:"f89e1773f4dd0ab54a474e085896877d",name:"Litecoin",unit:"LTC"},{id:"091527f0a496d0eafd2754f1b9590aa9",name:"Nervos",unit:"CKB",icon:"pi-ckb"},{id:"2c0847f66f16adcc6ddf93f1db5827e7",name:"Cosmos",unit:"ATOM",icon:"pi-atom"},{id:"d3428ee9afeb947b67aa37e634148ee5",name:"EOS",unit:"EOS"},{id:"ad4df7721cbab485e8fc04479aecd7e0",name:"Zcash",unit:"ZEC"},{id:"0ada0159f6906ac6d4e9634885c06bbc",name:"Horizen",unit:"ZEN",icon:"pi-zen"},{id:"17e296456ad17014fd9785da82c18a0c",name:"StellarLumens",unit:"XLM"},{id:"c33eb0623e9324c722c1e0a5d1fdb2a3",name:"Polkadot",unit:"DOT",icon:"pi-dot"},{id:"c0062863e3e99f67607ad1ae9a4299a7",name:"Ripple",unit:"XRP"},{id:"dd48f2c21016915ba6c795f320a4cf83",name:"TRON",unit:"TRX"},{id:"96678759312f067a9fd622b637502e36",name:"MakerDAO",unit:"DAI",icon:"pi-dai"},{id:"23ec191a8c1a7fa3c70c6088cd23e634",name:"Filecoin",unit:"FIL",icon:"pi-fil"}],legalTenders:[{id:"9b88c95a15e018c3f8038a7d0160145c",name:"Paypal",unit:o.default.DefaultUnitOfMoney,isLegalTender:!0,icon:"mif-paypal"},{id:"92a176f8a430b8b977ffe5fcff601372",name:"Alipay",unit:o.default.DefaultUnitOfMoney,isLegalTender:!0,icon:"pi-alipay"},{id:"c20ff00858b26de6ff99273ec51c18de",name:"WeChatPay",unit:o.default.DefaultUnitOfMoney,isLegalTender:!0,icon:"pi-wechat"}]}},640:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WithdrawAccount=void 0,t.WithdrawAccount=class{}},590:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),o=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),o(a(340),t),o(a(545),t),o(a(640),t)},315:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserUtility=void 0,t.BrowserUtility=class{static IsMobileBrowser(){let e=navigator.userAgent||navigator.vendor;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))}}},918:function(e,t,a){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DataService=void 0;const o=n(a(805)),c=a(412);class i{query(e,t,a,n="GET"){const o=Metro.activity.open({type:"cycle"});$.ajax({url:e,dataType:"json",type:n,contentType:"application/x-www-form-urlencoded",data:t,async:!0,processData:!1,cache:!1,success:function(e,t,n){Metro.activity.close(o),"function"!=typeof a||a(e)},error:function(e,t,a){Metro.activity.close(o);const n="【Status】"+t+"【error】"+a+"【others】"+e.responseText;c.UIHelper.ShowError("ERROR",n)}})}async getAsync(e,t){const a=Metro.activity.open({type:"cycle"}),n=await o.default.http(new Request(e,{method:"get"}));return Metro.activity.close(a),n}async postAsync(e,t){const a=Metro.activity.open({type:"cycle"}),n=await o.default.http(new Request(e,{method:"post",body:t}));return Metro.activity.close(a),n}}t.DataService=i,i.ApiPrefix="/api/v0/",i.Api_Account_ListAll=i.ApiPrefix+"account/all",i.Api_Account_Save=i.ApiPrefix+"account/save",i.Api_Currency_ListAll=i.ApiPrefix+"currency/all"},970:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InputUtility=void 0,t.InputUtility=class{static copyToClipboard(){try{document.execCommand("copy")}catch(e){console.log("InputUtility.copyToClipboard: "+e)}}static async fileToBase64(e){return new Promise(((t,a)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>t(n.result),n.onerror=e=>a(e)}))}}},805:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class a{static async http(e){const t=await fetch(e);return t.parsedBody=await t.json(),t}static async get(e,t={method:"get"}){return await a.http(new Request(e,t))}static async post(e,t,n={method:"post",body:JSON.stringify(t)}){return await a.http(new Request(e,n))}static async put(e,t,n={method:"put",body:JSON.stringify(t)}){return await a.http(new Request(e,n))}}t.default=a},274:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StringUtility=void 0,t.StringUtility=class{static EscapeSpecialChars(e){return e.replace(/\\n/g,"\\n").replace(/\\'/g,"\\'").replace(/\\"/g,'\\"').replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f")}static base64EncodeUnicode(e){return window&&"btoa"in window&&"encodeURIComponent"in window?btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,((e,t)=>String.fromCharCode("0x"+t)))):(console.warn("base64EncodeUnicode requirements: window.btoa and window.encodeURIComponent functions"),null)}}},412:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UIHelper=void 0,t.UIHelper=class{static ShowCharm(e){Metro.charms.open("#"+e)}static HideCharm(e){Metro.charms.close("#"+e)}static HideCharms(e){e.forEach((e=>{Metro.charms.close("#"+e)}))}static ToggleCharm(e){Metro.charms.toggle("#"+e)}static disableElement(e){$("#"+e).attr("disabled","true")}static enableElement(e){$("#"+e).attr("disabled","false")}static ShowMessage(e,t){Metro.notify.create(t,e,{cls:"info"})}static ShowError(e,t){Metro.notify.create(t,e,{cls:"alert"})}static ToastError(e,t=5e3){(0,Metro.toast.create)(e,null,t,"bg-red fg-white")}static ToastMessage(e,t=5e3){(0,Metro.toast.create)(e,null,t,"bg-green fg-white")}static LaunchFullScreen(e){e.requestFullscreen&&e.requestFullscreen()}static SetupFullScreen(e,t){e.addEventListener&&(e.addEventListener("webkitfullscreenchange",(()=>{t&&t()}),!1),e.addEventListener("mozfullscreenchange",(()=>{t&&t()}),!1),e.addEventListener("fullscreenchange",(()=>{t&&t()}),!1),e.addEventListener("MSFullscreenChange",(()=>{t&&t()}),!1))}static Refresh(){window.location.reload()}static GoBack(){window.history.back()}static CreateQRCode(e,t,a=256){const n=document.getElementById(e);n&&new QRCode(n,{text:t,width:a,height:a})}}},316:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),o=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),o(a(315),t),o(a(918),t),o(a(970),t),o(a(805),t),o(a(274),t),o(a(412),t)},527:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AccountViewModel=void 0;const n=a(316),o=a(39),c=a(335);class i extends c.AccountViewModelBase{constructor(){super()}async init(){const e=await this.api.getAsync(n.DataService.Api_Account_ListAll,{});this.accounts=e.parsedBody,this.fitCurrencies(),this.fitAccounts(),this.initVue()}initVue(){const e=this,t={data:()=>({accounts:e.accounts}),methods:{copyAccount:function(t){e.copyAccount(t)},submitTransaction:function(t){e.accounts[t]},toggleCard:function(e){$("#card_"+e).toggleClass("active")},getIconInfo:function(t){return"<span class='"+e.accounts[t].theCurrency.icon+"'></span>"}},mounted:function(){Metro.init(),e.afterMetroReady()}};this.app=o.createApp(t).mount("#app")}copyAccount(e){document.getElementById("taAccount_"+e).select(),n.InputUtility.copyToClipboard()}afterMetroReady(){this.initAccountCards()}}t.AccountViewModel=i},335:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AccountViewModelBase=void 0;const n=a(590),o=a(316),c=a(256);class i extends c.ViewModelBase{constructor(){super(),this.currencies=_.concat(n.CurrencyCandidates.Data.cryptoCoins,n.CurrencyCandidates.Data.legalTenders)}fitCurrencies(){this.currencies.forEach((e=>{e.icon||(e.icon="cc "+e.unit)}))}fitAccounts(){this.accounts.forEach((e=>{const t=this.currencies.find((t=>e.currencyId===t.id));e.theCurrency=_.clone(t)}))}initQRCodeOfCard(e,t){t.qrcode&&t.qrcode.length>4||o.UIHelper.CreateQRCode("qrcode_"+e,t.account,200)}initCardEffect(e,t="card_"){if(e<0)return;const a=document.getElementById(t+e),n=a.children[0].children[0],o=a.children[1].children[0];a.addEventListener("mouseenter",(e=>{n.classList.add("shadow-1"),o.classList.add("shadow-1")})),a.addEventListener("mouseleave",(e=>{n.classList.remove("shadow-1"),o.classList.remove("shadow-1")}))}initAccountCards(){for(let e=0;e<this.accounts.length;e++){const t=this.accounts[e];this.initQRCodeOfCard(e,t),this.initCardEffect(e)}}}t.AccountViewModelBase=i},203:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CurrencyManagerViewModel=void 0;const n=a(590),o=a(316),c=a(39),i=a(256);class r extends i.ViewModelBase{constructor(){super()}async init(){const e=await this.api.getAsync(o.DataService.Api_Account_ListAll,{});this.currencies=e.parsedBody,this.initVue()}initVue(){const e=this,t=_.concat(n.CurrencyCandidates.Data.cryptoCoins,n.CurrencyCandidates.Data.legalTenders);_.forEach(t,(t=>{t.icon="cc "+t.unit;const a=e.currencies.findIndex((e=>e.id===t.id));t.supported=a>=0,t.statusColor=a<0?"cyan":"green"}));const a={data:()=>({accounts:t}),methods:{supportCurrency:function(e){}},mounted:function(){Metro.init(),e.afterMetroReady()}};this.app=c.createApp(a).mount("#app")}afterMetroReady(){}}t.CurrencyManagerViewModel=r},105:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SinglePageViewModel=void 0;const n=a(316),o=a(256),c=a(39),i=a(448);class r extends o.ViewModelBase{constructor(e,t){super(),this.data=t,this.init(e)}init(e){this.data.accounts.forEach((e=>{e.iconInfo="<span class='cc "+e.theCurrency.unit+"'></span>"}));const t=this,a={data:()=>({username:t.data.username,nickname:t.data.nickname,avatar:t.data.avatar,accounts:t.data.accounts,visitorName:"n/a",visitorAvatar:"https://robohash.org/payhub.png",visitorAddress:"n/a",visitorCapacity:0,visitorFree:0}),methods:{copyAccount:function(e){document.getElementById("taAccount_"+e).select(),n.InputUtility.copyToClipboard()},toggleCard:function(e){$("#card_"+e).toggleClass("active")}},mounted:function(){console.log("vue mounted."),Metro.init(),t.afterMetroReady(t)}};this.app=c.createApp(a).mount("#"+e)}afterMetroReady(e){const t=e.data;for(let e=0;e<t.accounts.length;e++){const a=t.accounts[e],o=document.getElementById("card_"+e),c=o.children[0].children[0],i=o.children[1].children[0];o.addEventListener("mouseenter",(e=>{c.classList.add("shadow-1"),i.classList.add("shadow-1")})),o.addEventListener("mouseleave",(e=>{c.classList.remove("shadow-1"),i.classList.remove("shadow-1")})),a.qrcode&&a.qrcode.length>4||n.UIHelper.CreateQRCode("qrcode_"+e,a.account,200)}e.keyperingBank=new i.KeyperingBank,e.tryLoad().then((()=>{}))}async tryLoad(){const e=await this.keyperingBank.load();if(console.log(e),console.log(this.keyperingBank.account),e&&this.keyperingBank.account){const e=this.keyperingBank.account.address;this.app.visitorName="You",this.app.visitorAvatar=`https://robohash.org/${e}.png`,this.app.visitorAddress=e,this.app.visitorCapacity=this.keyperingBank.capacity,this.app.visitorFree=this.keyperingBank.free}}async connectKeypering(){await this.keyperingBank.connect(),await this.tryLoad()}}t.SinglePageViewModel=r},256:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ViewModelBase=void 0;const n=a(316);t.ViewModelBase=class{constructor(){this.api=new n.DataService}}},575:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WalletViewModel=void 0;const n=a(39),o=a(316),c=a(316),i=a(335);class r extends i.AccountViewModelBase{constructor(){super()}async init(){const e=await this.api.getAsync(o.DataService.Api_Account_ListAll,{});this.accounts=e.parsedBody,this.updateCurrenciesStatus(),this.fitCurrencies(),this.fitAccounts(),this.initVue()}initVue(){const e=this,t={data(){return{accounts:this.accounts,currencies:this.currencies,theCurrency:{},accountName:"",accountAddress:"",autoGenerateQrcode:!0}},methods:{addAccount:function(e){const t=this.currencies[e];this.theCurrency=t,this.accountName=t.name+"("+t.unit+")",this.accountAddress="",c.UIHelper.ShowCharm("charmEditAccount")},editAccount:function(t){const a=this.accounts[t];this.theCurrency=e.currencies.find((e=>e.id===a.currencyId)),this.accountName=a.name,this.accountAddress=a.account,c.UIHelper.ShowCharm("charmEditAccount")},toggleCard:function(e){$("#card_"+e).toggleClass("active")},getIconInfo:function(t){return"<span class='"+e.accounts[t].theCurrency.icon+"'></span>"}},mounted:function(){Metro.init(),e.afterMetroReady()}};this.app=n.createApp(t).mount("#app")}updateCurrenciesStatus(){this.currencies.forEach((e=>{const t=this.accounts.findIndex((t=>t.currencyId===e.id));e.added=t>=0,e.statusColor=t<0?"cyan":"green"}))}async saveAccount(){const e=this,t=document.getElementById("qrcodeFile");let a="";t.files.length>0&&(a=await c.InputUtility.fileToBase64(t.files[0]));const n={currencyId:e.app.theCurrency.id,name:e.app.accountName,address:e.app.accountAddress,qrcode:a},i=(await this.api.postAsync(o.DataService.Api_Account_Save,JSON.stringify(n))).parsedBody;i&&i.id&&32===i.id.length?(c.UIHelper.ToastMessage("Saved!"),c.UIHelper.Refresh()):c.UIHelper.ToastError("Unkown Error!")}afterMetroReady(){this.initAccountCards()}}t.WalletViewModel=r},581:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),o=this&&this.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||n(t,e,a)};Object.defineProperty(t,"__esModule",{value:!0}),o(a(256),t),o(a(335),t),o(a(527),t),o(a(203),t),o(a(575),t),o(a(105),t)},607:function(e,t,a){var n=this&&this.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&n(t,e,a);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const i={Core:c(a(163)),Models:c(a(590)),Tools:c(a(316)),ViewModels:c(a(581)),Settings:c(a(290))};t.default=i},39:t=>{t.exports=e}},a={},n=function e(n){var o=a[n];if(void 0!==o)return o.exports;var c=a[n]={exports:{}};return t[n].call(c.exports,c,c.exports,e),c.exports}(607);return n.default})()}));
//# sourceMappingURL=payhub.js.map